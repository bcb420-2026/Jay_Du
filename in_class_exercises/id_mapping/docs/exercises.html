<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Exercises | worked Example</title>
  <meta name="description" content="Chapter 6 Exercises | worked Example" />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Exercises | worked Example" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Exercises | worked Example" />
  
  
  

<meta name="author" content="Ruth Isserlin" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="worked-examples-with-beforeafter-tables.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Identifier Mapping Tutorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="what-is-identifier-mapping.html"><a href="what-is-identifier-mapping.html"><i class="fa fa-check"></i><b>1</b> What is identifier mapping?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="what-is-identifier-mapping.html"><a href="what-is-identifier-mapping.html#visual-overview"><i class="fa fa-check"></i><b>1.1</b> Visual overview</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-data-from-geo.html"><a href="getting-data-from-geo.html"><i class="fa fa-check"></i><b>2</b> Getting data from GEO</a></li>
<li class="chapter" data-level="3" data-path="why-identifiers-are-messy.html"><a href="why-identifiers-are-messy.html"><i class="fa fa-check"></i><b>3</b> Why identifiers are messy</a></li>
<li class="chapter" data-level="4" data-path="biomart-step-by-step.html"><a href="biomart-step-by-step.html"><i class="fa fa-check"></i><b>4</b> biomaRt step-by-step</a>
<ul>
<li class="chapter" data-level="4.1" data-path="biomart-step-by-step.html"><a href="biomart-step-by-step.html#list-marts"><i class="fa fa-check"></i><b>4.1</b> 1. List marts</a></li>
<li class="chapter" data-level="4.2" data-path="biomart-step-by-step.html"><a href="biomart-step-by-step.html#optional-pin-an-ensembl-archive-version"><i class="fa fa-check"></i><b>4.2</b> 2. (Optional) pin an Ensembl archive version</a></li>
<li class="chapter" data-level="4.3" data-path="biomart-step-by-step.html"><a href="biomart-step-by-step.html#list-datasets-and-select-human"><i class="fa fa-check"></i><b>4.3</b> 3. List datasets and select human</a></li>
<li class="chapter" data-level="4.4" data-path="biomart-step-by-step.html"><a href="biomart-step-by-step.html#identify-the-correct-filter"><i class="fa fa-check"></i><b>4.4</b> 4. Identify the correct filter</a></li>
<li class="chapter" data-level="4.5" data-path="biomart-step-by-step.html"><a href="biomart-step-by-step.html#identify-the-correct-attributes"><i class="fa fa-check"></i><b>4.5</b> 5. Identify the correct attributes</a></li>
<li class="chapter" data-level="4.6" data-path="biomart-step-by-step.html"><a href="biomart-step-by-step.html#strip-version-suffixes-if-present"><i class="fa fa-check"></i><b>4.6</b> 6. Strip version suffixes (if present)</a></li>
<li class="chapter" data-level="4.7" data-path="biomart-step-by-step.html"><a href="biomart-step-by-step.html#run-the-query-with-getbm"><i class="fa fa-check"></i><b>4.7</b> 7. Run the query with <code>getBM()</code></a></li>
<li class="chapter" data-level="4.8" data-path="biomart-step-by-step.html"><a href="biomart-step-by-step.html#cache-the-mapping-recommended"><i class="fa fa-check"></i><b>4.8</b> 8. Cache the mapping (recommended)</a></li>
<li class="chapter" data-level="4.9" data-path="biomart-step-by-step.html"><a href="biomart-step-by-step.html#merge-back-into-your-data"><i class="fa fa-check"></i><b>4.9</b> 9. Merge back into your data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="worked-examples-with-beforeafter-tables.html"><a href="worked-examples-with-beforeafter-tables.html"><i class="fa fa-check"></i><b>5</b> Worked examples with before/after tables</a>
<ul>
<li class="chapter" data-level="5.1" data-path="worked-examples-with-beforeafter-tables.html"><a href="worked-examples-with-beforeafter-tables.html#gse233947"><i class="fa fa-check"></i><b>5.1</b> GSE233947</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>6</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.1" data-path="exercises.html"><a href="exercises.html#exercise-1-httpswww.ncbi.nlm.nih.govgeoqueryacc.cgiaccgse119732"><i class="fa fa-check"></i><b>6.1</b> Exercise 1 — https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE119732</a></li>
<li class="chapter" data-level="6.2" data-path="exercises.html"><a href="exercises.html#exercise-2-httpswww.ncbi.nlm.nih.govgeoqueryacc.cgiaccgse122380"><i class="fa fa-check"></i><b>6.2</b> Exercise 2 — https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE122380</a></li>
<li class="chapter" data-level="6.3" data-path="exercises.html"><a href="exercises.html#exercise-3--"><i class="fa fa-check"></i><b>6.3</b> Exercise 3 -</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">worked Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercises" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Exercises<a href="exercises.html#exercises" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>These are intended to be done <strong>after</strong> completing the worked examples.</p>
<div id="exercise-1-httpswww.ncbi.nlm.nih.govgeoqueryacc.cgiaccgse119732" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Exercise 1 — <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE119732" class="uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE119732</a><a href="exercises.html#exercise-1-httpswww.ncbi.nlm.nih.govgeoqueryacc.cgiaccgse119732" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Using <strong>GSE119732</strong>, confirm whether the ID column contains Ensembl IDs with version suffixes.</p>
<ol style="list-style-type: decimal">
<li>Extract the first 20 IDs.</li>
<li>Count how many contain a <code>.</code>.</li>
<li>Create a new column with versions stripped.</li>
<li>Map the identifiers to HGNC symbols.</li>
</ol>
<div id="helper-functions" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Helper functions<a href="exercises.html#helper-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="exercises.html#cb75-1" tabindex="-1"></a><span class="co"># Load Library</span></span>
<span id="cb75-2"><a href="exercises.html#cb75-2" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb75-3"><a href="exercises.html#cb75-3" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb75-4"><a href="exercises.html#cb75-4" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="exercises.html#cb79-1" tabindex="-1"></a><span class="co"># Print first n from head</span></span>
<span id="cb79-2"><a href="exercises.html#cb79-2" tabindex="-1"></a>kable_head <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">caption =</span> <span class="cn">NULL</span>) {</span>
<span id="cb79-3"><a href="exercises.html#cb79-3" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(utils<span class="sc">::</span><span class="fu">head</span>(x, n), <span class="at">caption =</span> caption)</span>
<span id="cb79-4"><a href="exercises.html#cb79-4" tabindex="-1"></a>}</span>
<span id="cb79-5"><a href="exercises.html#cb79-5" tabindex="-1"></a></span>
<span id="cb79-6"><a href="exercises.html#cb79-6" tabindex="-1"></a><span class="co"># Safe read files</span></span>
<span id="cb79-7"><a href="exercises.html#cb79-7" tabindex="-1"></a>safe_read <span class="ot">&lt;-</span> <span class="cf">function</span>(file) {</span>
<span id="cb79-8"><a href="exercises.html#cb79-8" tabindex="-1"></a>  <span class="co"># First attempt: read as TSV</span></span>
<span id="cb79-9"><a href="exercises.html#cb79-9" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb79-10"><a href="exercises.html#cb79-10" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">read_tsv</span>(file, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>),</span>
<span id="cb79-11"><a href="exercises.html#cb79-11" tabindex="-1"></a>    <span class="at">error =</span> <span class="cf">function</span>(e) <span class="cn">NULL</span>   <span class="co"># catch fatal errors</span></span>
<span id="cb79-12"><a href="exercises.html#cb79-12" tabindex="-1"></a>  )</span>
<span id="cb79-13"><a href="exercises.html#cb79-13" tabindex="-1"></a>  </span>
<span id="cb79-14"><a href="exercises.html#cb79-14" tabindex="-1"></a>  <span class="co"># If read_tsv failed entirely:</span></span>
<span id="cb79-15"><a href="exercises.html#cb79-15" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(df)) {</span>
<span id="cb79-16"><a href="exercises.html#cb79-16" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">&quot;TSV read failed — reading as space-delimited file instead.&quot;</span>)</span>
<span id="cb79-17"><a href="exercises.html#cb79-17" tabindex="-1"></a>    <span class="fu">return</span>(readr<span class="sc">::</span><span class="fu">read_table</span>(file, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>))</span>
<span id="cb79-18"><a href="exercises.html#cb79-18" tabindex="-1"></a>  }</span>
<span id="cb79-19"><a href="exercises.html#cb79-19" tabindex="-1"></a>  </span>
<span id="cb79-20"><a href="exercises.html#cb79-20" tabindex="-1"></a>  <span class="co"># If read_tsv returned but with parsing issues:</span></span>
<span id="cb79-21"><a href="exercises.html#cb79-21" tabindex="-1"></a>  probs <span class="ot">&lt;-</span> <span class="fu">problems</span>(df)</span>
<span id="cb79-22"><a href="exercises.html#cb79-22" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(probs) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb79-23"><a href="exercises.html#cb79-23" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">&quot;Parsing issues detected in TSV — reading as space-delimited file instead.&quot;</span>)</span>
<span id="cb79-24"><a href="exercises.html#cb79-24" tabindex="-1"></a>    <span class="fu">return</span>(readr<span class="sc">::</span><span class="fu">read_table</span>(file, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>))</span>
<span id="cb79-25"><a href="exercises.html#cb79-25" tabindex="-1"></a>  }</span>
<span id="cb79-26"><a href="exercises.html#cb79-26" tabindex="-1"></a>  </span>
<span id="cb79-27"><a href="exercises.html#cb79-27" tabindex="-1"></a>  <span class="co"># If everything was fine:</span></span>
<span id="cb79-28"><a href="exercises.html#cb79-28" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb79-29"><a href="exercises.html#cb79-29" tabindex="-1"></a>}</span>
<span id="cb79-30"><a href="exercises.html#cb79-30" tabindex="-1"></a></span>
<span id="cb79-31"><a href="exercises.html#cb79-31" tabindex="-1"></a><span class="co"># Strip version number</span></span>
<span id="cb79-32"><a href="exercises.html#cb79-32" tabindex="-1"></a>strip_ensembl_version <span class="ot">&lt;-</span> <span class="cf">function</span>(ids) <span class="fu">sub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">..*$&quot;</span>, <span class="st">&quot;&quot;</span>, ids)</span>
<span id="cb79-33"><a href="exercises.html#cb79-33" tabindex="-1"></a></span>
<span id="cb79-34"><a href="exercises.html#cb79-34" tabindex="-1"></a></span>
<span id="cb79-35"><a href="exercises.html#cb79-35" tabindex="-1"></a><span class="co"># Load fetching function</span></span>
<span id="cb79-36"><a href="exercises.html#cb79-36" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;./fetch_geo_supp.R&quot;</span>)</span></code></pre></div>
</div>
<div id="question-1" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Question 1<a href="exercises.html#question-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="exercises.html#cb80-1" tabindex="-1"></a>gse <span class="ot">&lt;-</span> <span class="st">&quot;GSE119732&quot;</span></span>
<span id="cb80-2"><a href="exercises.html#cb80-2" tabindex="-1"></a>pattern <span class="ot">&lt;-</span> <span class="st">&quot;GSE119732.*</span><span class="sc">\\</span><span class="st">.gz&quot;</span></span>
<span id="cb80-3"><a href="exercises.html#cb80-3" tabindex="-1"></a></span>
<span id="cb80-4"><a href="exercises.html#cb80-4" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>, gse)</span>
<span id="cb80-5"><a href="exercises.html#cb80-5" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(path, <span class="at">pattern =</span> pattern, </span>
<span id="cb80-6"><a href="exercises.html#cb80-6" tabindex="-1"></a>                    <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-7"><a href="exercises.html#cb80-7" tabindex="-1"></a></span>
<span id="cb80-8"><a href="exercises.html#cb80-8" tabindex="-1"></a><span class="fu">kable_head</span>(<span class="fu">tibble</span>(<span class="at">file =</span> <span class="fu">basename</span>(files)), <span class="fu">min</span>(<span class="dv">10</span>, <span class="fu">length</span>(files)), <span class="fu">paste</span>(gse,<span class="st">&quot;: extracted file list (first 10)&quot;</span>))</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-2">Table 6.1: </span>GSE119732 : extracted file list (first 10)</caption>
<thead>
<tr class="header">
<th align="left">file</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GSE119732_count_table_RNA_seq.txt.gz</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="exercises.html#cb81-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">safe_read</span>(files[<span class="dv">1</span>])</span>
<span id="cb81-2"><a href="exercises.html#cb81-2" tabindex="-1"></a></span>
<span id="cb81-3"><a href="exercises.html#cb81-3" tabindex="-1"></a><span class="fu">kable_head</span>(x[, <span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">6</span>, <span class="fu">ncol</span>(x))], <span class="dv">20</span>, <span class="fu">paste</span>(gse,<span class="st">&quot;: raw table preview&quot;</span>))</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-2">Table 6.1: </span>GSE119732 : raw table preview</caption>
<thead>
<tr class="header">
<th align="left">gene_id</th>
<th align="right">A1</th>
<th align="right">A2</th>
<th align="right">A3</th>
<th align="right">A4</th>
<th align="right">B1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ENSG00000223972.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">ENSG00000227232.5</td>
<td align="right">79</td>
<td align="right">119</td>
<td align="right">84</td>
<td align="right">50</td>
<td align="right">80</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000278267.1</td>
<td align="right">17</td>
<td align="right">10</td>
<td align="right">22</td>
<td align="right">19</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td align="left">ENSG00000243485.4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000237613.2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">ENSG00000268020.3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000240361.1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">ENSG00000186092.4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000238009.6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">ENSG00000239945.1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000233750.3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">ENSG00000268903.1</td>
<td align="right">7</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">6</td>
<td align="right">29</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000269981.1</td>
<td align="right">17</td>
<td align="right">11</td>
<td align="right">14</td>
<td align="right">4</td>
<td align="right">27</td>
</tr>
<tr class="even">
<td align="left">ENSG00000239906.1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000241860.6</td>
<td align="right">6</td>
<td align="right">19</td>
<td align="right">12</td>
<td align="right">8</td>
<td align="right">60</td>
</tr>
<tr class="even">
<td align="left">ENSG00000222623.1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000241599.1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">ENSG00000279928.1</td>
<td align="right">8</td>
<td align="right">5</td>
<td align="right">9</td>
<td align="right">6</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000279457.3</td>
<td align="right">282</td>
<td align="right">298</td>
<td align="right">334</td>
<td align="right">205</td>
<td align="right">156</td>
</tr>
<tr class="even">
<td align="left">ENSG00000273874.1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="question-2" class="section level3 hasAnchor" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> Question 2<a href="exercises.html#question-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="exercises.html#cb82-1" tabindex="-1"></a><span class="co"># Extract the first 20 IDs</span></span>
<span id="cb82-2"><a href="exercises.html#cb82-2" tabindex="-1"></a>first_20_ids <span class="ot">&lt;-</span> <span class="fu">head</span>(x<span class="sc">$</span>gene_id, <span class="dv">20</span>)</span>
<span id="cb82-3"><a href="exercises.html#cb82-3" tabindex="-1"></a></span>
<span id="cb82-4"><a href="exercises.html#cb82-4" tabindex="-1"></a><span class="co"># Count how many of the first 20 contain a &quot;.&quot;</span></span>
<span id="cb82-5"><a href="exercises.html#cb82-5" tabindex="-1"></a>dot_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">grepl</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>, first_20_ids))</span>
<span id="cb82-6"><a href="exercises.html#cb82-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Number of IDs with version suffixes in first 20:&quot;</span>, dot_count))</span></code></pre></div>
<pre><code>## [1] &quot;Number of IDs with version suffixes in first 20: 20&quot;</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="exercises.html#cb84-1" tabindex="-1"></a><span class="co"># Count how many total contain a &quot;.&quot;</span></span>
<span id="cb84-2"><a href="exercises.html#cb84-2" tabindex="-1"></a>dot_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">grepl</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>, x<span class="sc">$</span>gene_id))</span>
<span id="cb84-3"><a href="exercises.html#cb84-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Total number of IDs with version suffixes:&quot;</span>, dot_count))</span></code></pre></div>
<pre><code>## [1] &quot;Total number of IDs with version suffixes: 58037&quot;</code></pre>
<p>All 20 from the 1st 20 have a “.”, all 58037 ids of this whole set
have a “.”.</p>
</div>
<div id="question-3" class="section level3 hasAnchor" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> Question 3<a href="exercises.html#question-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="exercises.html#cb86-1" tabindex="-1"></a><span class="co"># Apply to your tibble &#39;x&#39;</span></span>
<span id="cb86-2"><a href="exercises.html#cb86-2" tabindex="-1"></a>id_col <span class="ot">&lt;-</span> <span class="fu">names</span>(x)[<span class="dv">1</span>]</span>
<span id="cb86-3"><a href="exercises.html#cb86-3" tabindex="-1"></a>ids <span class="ot">&lt;-</span> x[[<span class="dv">1</span>]] <span class="sc">|&gt;</span> <span class="fu">as.character</span>()</span>
<span id="cb86-4"><a href="exercises.html#cb86-4" tabindex="-1"></a><span class="fu">kable_head</span>(<span class="fu">tibble</span>(<span class="at">raw_id =</span> <span class="fu">head</span>(ids, <span class="dv">10</span>), </span>
<span id="cb86-5"><a href="exercises.html#cb86-5" tabindex="-1"></a>                  <span class="at">stripped =</span> <span class="fu">strip_ensembl_version</span>(<span class="fu">head</span>(ids, <span class="dv">10</span>))), </span>
<span id="cb86-6"><a href="exercises.html#cb86-6" tabindex="-1"></a>           <span class="dv">10</span>, <span class="fu">paste</span>(gse,<span class="st">&quot;: ID preview&quot;</span>))</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-4">Table 6.2: </span>GSE119732 : ID preview</caption>
<thead>
<tr class="header">
<th align="left">raw_id</th>
<th align="left">stripped</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ENSG00000223972.5</td>
<td align="left">ENSG00000223972</td>
</tr>
<tr class="even">
<td align="left">ENSG00000227232.5</td>
<td align="left">ENSG00000227232</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000278267.1</td>
<td align="left">ENSG00000278267</td>
</tr>
<tr class="even">
<td align="left">ENSG00000243485.4</td>
<td align="left">ENSG00000243485</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000237613.2</td>
<td align="left">ENSG00000237613</td>
</tr>
<tr class="even">
<td align="left">ENSG00000268020.3</td>
<td align="left">ENSG00000268020</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000240361.1</td>
<td align="left">ENSG00000240361</td>
</tr>
<tr class="even">
<td align="left">ENSG00000186092.4</td>
<td align="left">ENSG00000186092</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000238009.6</td>
<td align="left">ENSG00000238009</td>
</tr>
<tr class="even">
<td align="left">ENSG00000239945.1</td>
<td align="left">ENSG00000239945</td>
</tr>
</tbody>
</table>
</div>
<div id="question-4" class="section level3 hasAnchor" number="6.1.5">
<h3><span class="header-section-number">6.1.5</span> Question 4<a href="exercises.html#question-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="exercises.html#cb87-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;^ENSG&quot;</span>, <span class="fu">strip_ensembl_version</span>(ids)))) {</span>
<span id="cb87-2"><a href="exercises.html#cb87-2" tabindex="-1"></a>  <span class="fu">library</span>(biomaRt)</span>
<span id="cb87-3"><a href="exercises.html#cb87-3" tabindex="-1"></a>  ensembl_ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">strip_ensembl_version</span>(ids))</span>
<span id="cb87-4"><a href="exercises.html#cb87-4" tabindex="-1"></a>  ensembl <span class="ot">&lt;-</span> <span class="fu">useMart</span>(<span class="st">&quot;ensembl&quot;</span>, <span class="at">dataset =</span> <span class="st">&quot;hsapiens_gene_ensembl&quot;</span>)</span>
<span id="cb87-5"><a href="exercises.html#cb87-5" tabindex="-1"></a>  </span>
<span id="cb87-6"><a href="exercises.html#cb87-6" tabindex="-1"></a>  map <span class="ot">&lt;-</span> <span class="fu">getBM</span>(</span>
<span id="cb87-7"><a href="exercises.html#cb87-7" tabindex="-1"></a>    <span class="at">attributes =</span> <span class="fu">c</span>(<span class="st">&quot;ensembl_gene_id&quot;</span>, <span class="st">&quot;hgnc_symbol&quot;</span>),</span>
<span id="cb87-8"><a href="exercises.html#cb87-8" tabindex="-1"></a>    <span class="at">filters =</span> <span class="st">&quot;ensembl_gene_id&quot;</span>,</span>
<span id="cb87-9"><a href="exercises.html#cb87-9" tabindex="-1"></a>    <span class="at">values =</span> ensembl_ids,</span>
<span id="cb87-10"><a href="exercises.html#cb87-10" tabindex="-1"></a>    <span class="at">mart =</span> ensembl</span>
<span id="cb87-11"><a href="exercises.html#cb87-11" tabindex="-1"></a>  )</span>
<span id="cb87-12"><a href="exercises.html#cb87-12" tabindex="-1"></a>  </span>
<span id="cb87-13"><a href="exercises.html#cb87-13" tabindex="-1"></a>  <span class="fu">kable_head</span>(map, <span class="dv">10</span>, <span class="fu">paste</span>(gse,<span class="st">&quot;: mapping preview&quot;</span>))</span>
<span id="cb87-14"><a href="exercises.html#cb87-14" tabindex="-1"></a>  </span>
<span id="cb87-15"><a href="exercises.html#cb87-15" tabindex="-1"></a>  expr_mapped <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span></span>
<span id="cb87-16"><a href="exercises.html#cb87-16" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ensembl_gene_id =</span> <span class="fu">strip_ensembl_version</span>(.data[[id_col]])) <span class="sc">%&gt;%</span></span>
<span id="cb87-17"><a href="exercises.html#cb87-17" tabindex="-1"></a>    <span class="fu">left_join</span>(map, <span class="at">by =</span> <span class="st">&quot;ensembl_gene_id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb87-18"><a href="exercises.html#cb87-18" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>( ensembl_gene_id,hgnc_symbol, <span class="fu">everything</span>())</span>
<span id="cb87-19"><a href="exercises.html#cb87-19" tabindex="-1"></a>  </span>
<span id="cb87-20"><a href="exercises.html#cb87-20" tabindex="-1"></a>  </span>
<span id="cb87-21"><a href="exercises.html#cb87-21" tabindex="-1"></a>  <span class="fu">kable_head</span>(expr_mapped[, <span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">8</span>, <span class="fu">ncol</span>(expr_mapped))], <span class="dv">5</span>, <span class="fu">paste</span>(gse,<span class="st">&quot;: mapped table preview&quot;</span>))</span>
<span id="cb87-22"><a href="exercises.html#cb87-22" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning in left_join(., map, by = &quot;ensembl_gene_id&quot;): Detected an unexpected many-to-many relationship between `x` and `y`.
## ℹ Row 29117 of `x` matches multiple rows in `y`.
## ℹ Row 53969 of `y` matches multiple rows in `x`.
## ℹ If a many-to-many relationship is expected, set `relationship =
##   &quot;many-to-many&quot;` to silence this warning.</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-5">Table 6.3: </span>GSE119732 : mapped table preview</caption>
<thead>
<tr class="header">
<th align="left">ensembl_gene_id</th>
<th align="left">hgnc_symbol</th>
<th align="left">gene_id</th>
<th align="right">A1</th>
<th align="right">A2</th>
<th align="right">A3</th>
<th align="right">A4</th>
<th align="right">B1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ENSG00000223972</td>
<td align="left">DDX11L1</td>
<td align="left">ENSG00000223972.5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">ENSG00000227232</td>
<td align="left">WASH7P</td>
<td align="left">ENSG00000227232.5</td>
<td align="right">79</td>
<td align="right">119</td>
<td align="right">84</td>
<td align="right">50</td>
<td align="right">80</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000278267</td>
<td align="left">MIR6859-1</td>
<td align="left">ENSG00000278267.1</td>
<td align="right">17</td>
<td align="right">10</td>
<td align="right">22</td>
<td align="right">19</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td align="left">ENSG00000243485</td>
<td align="left">MIR1302-2HG</td>
<td align="left">ENSG00000243485.4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000237613</td>
<td align="left">FAM138A</td>
<td align="left">ENSG00000237613.2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="exercise-2-httpswww.ncbi.nlm.nih.govgeoqueryacc.cgiaccgse122380" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Exercise 2 — <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE122380" class="uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE122380</a><a href="exercises.html#exercise-2-httpswww.ncbi.nlm.nih.govgeoqueryacc.cgiaccgse122380" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Using <strong>GSE122380</strong>, confirm whether the ID column contains Ensembl IDs with version suffixes.</p>
<ol style="list-style-type: decimal">
<li>Extract the first 20 IDs.</li>
<li>Create a new column with versions stripped.</li>
<li>Map the identifiers to HGNC symbols.</li>
<li>What is different about this file?</li>
</ol>
<div id="question-1-1" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Question 1<a href="exercises.html#question-1-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="exercises.html#cb89-1" tabindex="-1"></a>gse <span class="ot">&lt;-</span> <span class="st">&quot;GSE122380&quot;</span></span>
<span id="cb89-2"><a href="exercises.html#cb89-2" tabindex="-1"></a>pattern <span class="ot">&lt;-</span> <span class="st">&quot;GSE122380.*</span><span class="sc">\\</span><span class="st">.gz&quot;</span></span>
<span id="cb89-3"><a href="exercises.html#cb89-3" tabindex="-1"></a></span>
<span id="cb89-4"><a href="exercises.html#cb89-4" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;data&quot;</span>, gse)</span>
<span id="cb89-5"><a href="exercises.html#cb89-5" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(path, <span class="at">pattern =</span> pattern, </span>
<span id="cb89-6"><a href="exercises.html#cb89-6" tabindex="-1"></a>                    <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-7"><a href="exercises.html#cb89-7" tabindex="-1"></a></span>
<span id="cb89-8"><a href="exercises.html#cb89-8" tabindex="-1"></a><span class="fu">kable_head</span>(<span class="fu">tibble</span>(<span class="at">file =</span> <span class="fu">basename</span>(files)), <span class="fu">min</span>(<span class="dv">10</span>, <span class="fu">length</span>(files)), <span class="fu">paste</span>(gse,<span class="st">&quot;: extracted file list (first 10)&quot;</span>))</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-6">Table 6.4: </span>GSE122380 : extracted file list (first 10)</caption>
<thead>
<tr class="header">
<th align="left">file</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GSE122380_raw_counts.txt.gz</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="exercises.html#cb90-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">safe_read</span>(files[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## Warning: One or more parsing issues, call `problems()` on your data frame for details,
## e.g.:
##   dat &lt;- vroom(...)
##   problems(dat)</code></pre>
<pre><code>## Parsing issues detected in TSV — reading as space-delimited file instead.</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="exercises.html#cb93-1" tabindex="-1"></a><span class="fu">kable_head</span>(x[, <span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">6</span>, <span class="fu">ncol</span>(x))], <span class="dv">20</span>, <span class="fu">paste</span>(gse,<span class="st">&quot;: raw table preview&quot;</span>))</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-6">Table 6.4: </span>GSE122380 : raw table preview</caption>
<thead>
<tr class="header">
<th align="left">Gene_id</th>
<th align="right">18489_0</th>
<th align="right">18489_10</th>
<th align="right">18489_11</th>
<th align="right">18489_12</th>
<th align="right">18489_13</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ENSG00000000419</td>
<td align="right">825</td>
<td align="right">549</td>
<td align="right">576</td>
<td align="right">599</td>
<td align="right">607</td>
</tr>
<tr class="even">
<td align="left">ENSG00000000457</td>
<td align="right">175</td>
<td align="right">238</td>
<td align="right">279</td>
<td align="right">254</td>
<td align="right">327</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000000460</td>
<td align="right">337</td>
<td align="right">103</td>
<td align="right">120</td>
<td align="right">124</td>
<td align="right">154</td>
</tr>
<tr class="even">
<td align="left">ENSG00000000938</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000000971</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">10</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">ENSG00000001036</td>
<td align="right">2251</td>
<td align="right">860</td>
<td align="right">819</td>
<td align="right">732</td>
<td align="right">1071</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000001084</td>
<td align="right">980</td>
<td align="right">833</td>
<td align="right">694</td>
<td align="right">615</td>
<td align="right">959</td>
</tr>
<tr class="even">
<td align="left">ENSG00000001167</td>
<td align="right">886</td>
<td align="right">991</td>
<td align="right">889</td>
<td align="right">1164</td>
<td align="right">1000</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000001460</td>
<td align="right">239</td>
<td align="right">215</td>
<td align="right">142</td>
<td align="right">171</td>
<td align="right">225</td>
</tr>
<tr class="even">
<td align="left">ENSG00000001461</td>
<td align="right">402</td>
<td align="right">798</td>
<td align="right">664</td>
<td align="right">777</td>
<td align="right">907</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000001561</td>
<td align="right">336</td>
<td align="right">293</td>
<td align="right">207</td>
<td align="right">195</td>
<td align="right">309</td>
</tr>
<tr class="even">
<td align="left">ENSG00000001617</td>
<td align="right">1850</td>
<td align="right">955</td>
<td align="right">472</td>
<td align="right">1174</td>
<td align="right">737</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000001626</td>
<td align="right">100</td>
<td align="right">55</td>
<td align="right">46</td>
<td align="right">101</td>
<td align="right">52</td>
</tr>
<tr class="even">
<td align="left">ENSG00000001629</td>
<td align="right">1266</td>
<td align="right">1055</td>
<td align="right">1037</td>
<td align="right">1255</td>
<td align="right">1248</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000001630</td>
<td align="right">157</td>
<td align="right">176</td>
<td align="right">150</td>
<td align="right">130</td>
<td align="right">179</td>
</tr>
<tr class="even">
<td align="left">ENSG00000001631</td>
<td align="right">641</td>
<td align="right">843</td>
<td align="right">812</td>
<td align="right">861</td>
<td align="right">984</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000002016</td>
<td align="right">403</td>
<td align="right">543</td>
<td align="right">354</td>
<td align="right">428</td>
<td align="right">464</td>
</tr>
<tr class="even">
<td align="left">ENSG00000002330</td>
<td align="right">131</td>
<td align="right">299</td>
<td align="right">301</td>
<td align="right">298</td>
<td align="right">374</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000002549</td>
<td align="right">742</td>
<td align="right">869</td>
<td align="right">902</td>
<td align="right">713</td>
<td align="right">973</td>
</tr>
<tr class="even">
<td align="left">ENSG00000002587</td>
<td align="right">11</td>
<td align="right">50</td>
<td align="right">51</td>
<td align="right">54</td>
<td align="right">30</td>
</tr>
</tbody>
</table>
</div>
<div id="question-2-1" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Question 2<a href="exercises.html#question-2-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="exercises.html#cb94-1" tabindex="-1"></a><span class="co"># Extract the first 20 IDs</span></span>
<span id="cb94-2"><a href="exercises.html#cb94-2" tabindex="-1"></a>first_20_ids <span class="ot">&lt;-</span> <span class="fu">head</span>(x<span class="sc">$</span>gene_id, <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## Warning: Unknown or uninitialised column: `gene_id`.</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="exercises.html#cb96-1" tabindex="-1"></a><span class="co"># Count how many of the first 20 contain a &quot;.&quot;</span></span>
<span id="cb96-2"><a href="exercises.html#cb96-2" tabindex="-1"></a>dot_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">grepl</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>, first_20_ids))</span>
<span id="cb96-3"><a href="exercises.html#cb96-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Number of IDs with version suffixes in first 20:&quot;</span>, dot_count))</span></code></pre></div>
<pre><code>## [1] &quot;Number of IDs with version suffixes in first 20: 0&quot;</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="exercises.html#cb98-1" tabindex="-1"></a><span class="co"># Count how many total contain a &quot;.&quot;</span></span>
<span id="cb98-2"><a href="exercises.html#cb98-2" tabindex="-1"></a>dot_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">grepl</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>, x<span class="sc">$</span>gene_id))</span></code></pre></div>
<pre><code>## Warning: Unknown or uninitialised column: `gene_id`.</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="exercises.html#cb100-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Total number of IDs with version suffixes:&quot;</span>, dot_count))</span></code></pre></div>
<pre><code>## [1] &quot;Total number of IDs with version suffixes: 0&quot;</code></pre>
<p>0 from the 1st 20 have a “.”, all ids of this whole set
dpn’t have a “.”.</p>
</div>
<div id="question-3-1" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Question 3<a href="exercises.html#question-3-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="exercises.html#cb102-1" tabindex="-1"></a><span class="co"># Define the ID column name</span></span>
<span id="cb102-2"><a href="exercises.html#cb102-2" tabindex="-1"></a>id_col <span class="ot">&lt;-</span> <span class="fu">names</span>(x)[<span class="dv">1</span>]</span>
<span id="cb102-3"><a href="exercises.html#cb102-3" tabindex="-1"></a>ids <span class="ot">&lt;-</span> x[[<span class="dv">1</span>]] <span class="sc">|&gt;</span> <span class="fu">as.character</span>()</span>
<span id="cb102-4"><a href="exercises.html#cb102-4" tabindex="-1"></a></span>
<span id="cb102-5"><a href="exercises.html#cb102-5" tabindex="-1"></a><span class="co"># Since IDs don&#39;t have dots, we use them directly</span></span>
<span id="cb102-6"><a href="exercises.html#cb102-6" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">&quot;^ENSG&quot;</span>, ids))) {</span>
<span id="cb102-7"><a href="exercises.html#cb102-7" tabindex="-1"></a>  <span class="fu">library</span>(biomaRt)</span>
<span id="cb102-8"><a href="exercises.html#cb102-8" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb102-9"><a href="exercises.html#cb102-9" tabindex="-1"></a>  </span>
<span id="cb102-10"><a href="exercises.html#cb102-10" tabindex="-1"></a>  ensembl_ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(ids)</span>
<span id="cb102-11"><a href="exercises.html#cb102-11" tabindex="-1"></a>  ensembl <span class="ot">&lt;-</span> <span class="fu">useMart</span>(<span class="st">&quot;ensembl&quot;</span>, <span class="at">dataset =</span> <span class="st">&quot;hsapiens_gene_ensembl&quot;</span>)</span>
<span id="cb102-12"><a href="exercises.html#cb102-12" tabindex="-1"></a>  </span>
<span id="cb102-13"><a href="exercises.html#cb102-13" tabindex="-1"></a>  <span class="co"># Fetch the mapping</span></span>
<span id="cb102-14"><a href="exercises.html#cb102-14" tabindex="-1"></a>  map <span class="ot">&lt;-</span> <span class="fu">getBM</span>(</span>
<span id="cb102-15"><a href="exercises.html#cb102-15" tabindex="-1"></a>    <span class="at">attributes =</span> <span class="fu">c</span>(<span class="st">&quot;ensembl_gene_id&quot;</span>, <span class="st">&quot;hgnc_symbol&quot;</span>),</span>
<span id="cb102-16"><a href="exercises.html#cb102-16" tabindex="-1"></a>    <span class="at">filters =</span> <span class="st">&quot;ensembl_gene_id&quot;</span>,</span>
<span id="cb102-17"><a href="exercises.html#cb102-17" tabindex="-1"></a>    <span class="at">values =</span> ensembl_ids,</span>
<span id="cb102-18"><a href="exercises.html#cb102-18" tabindex="-1"></a>    <span class="at">mart =</span> ensembl</span>
<span id="cb102-19"><a href="exercises.html#cb102-19" tabindex="-1"></a>  )</span>
<span id="cb102-20"><a href="exercises.html#cb102-20" tabindex="-1"></a>  </span>
<span id="cb102-21"><a href="exercises.html#cb102-21" tabindex="-1"></a>  <span class="fu">kable_head</span>(map, <span class="dv">10</span>, <span class="fu">paste</span>(gse, <span class="st">&quot;: mapping preview (cleaned)&quot;</span>))</span>
<span id="cb102-22"><a href="exercises.html#cb102-22" tabindex="-1"></a>  </span>
<span id="cb102-23"><a href="exercises.html#cb102-23" tabindex="-1"></a>  <span class="co"># Join using the original IDs directly</span></span>
<span id="cb102-24"><a href="exercises.html#cb102-24" tabindex="-1"></a>  expr_mapped <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span></span>
<span id="cb102-25"><a href="exercises.html#cb102-25" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ensembl_gene_id =</span> .data[[id_col]]) <span class="sc">%&gt;%</span></span>
<span id="cb102-26"><a href="exercises.html#cb102-26" tabindex="-1"></a>    <span class="fu">left_join</span>(map, <span class="at">by =</span> <span class="st">&quot;ensembl_gene_id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-27"><a href="exercises.html#cb102-27" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(ensembl_gene_id,hgnc_symbol, <span class="fu">everything</span>())</span>
<span id="cb102-28"><a href="exercises.html#cb102-28" tabindex="-1"></a>  </span>
<span id="cb102-29"><a href="exercises.html#cb102-29" tabindex="-1"></a>  <span class="co"># Preview the final table</span></span>
<span id="cb102-30"><a href="exercises.html#cb102-30" tabindex="-1"></a>  <span class="fu">kable_head</span>(expr_mapped[, <span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">8</span>, <span class="fu">ncol</span>(expr_mapped))], <span class="dv">10</span>, <span class="fu">paste</span>(gse, <span class="st">&quot;: mapped table preview&quot;</span>))</span>
<span id="cb102-31"><a href="exercises.html#cb102-31" tabindex="-1"></a>}</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-8">Table 6.5: </span>GSE122380 : mapped table preview</caption>
<colgroup>
<col width="18%" />
<col width="13%" />
<col width="18%" />
<col width="9%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">ensembl_gene_id</th>
<th align="left">hgnc_symbol</th>
<th align="left">Gene_id</th>
<th align="right">18489_0</th>
<th align="right">18489_10</th>
<th align="right">18489_11</th>
<th align="right">18489_12</th>
<th align="right">18489_13</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ENSG00000000419</td>
<td align="left">DPM1</td>
<td align="left">ENSG00000000419</td>
<td align="right">825</td>
<td align="right">549</td>
<td align="right">576</td>
<td align="right">599</td>
<td align="right">607</td>
</tr>
<tr class="even">
<td align="left">ENSG00000000457</td>
<td align="left">SCYL3</td>
<td align="left">ENSG00000000457</td>
<td align="right">175</td>
<td align="right">238</td>
<td align="right">279</td>
<td align="right">254</td>
<td align="right">327</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000000460</td>
<td align="left">FIRRM</td>
<td align="left">ENSG00000000460</td>
<td align="right">337</td>
<td align="right">103</td>
<td align="right">120</td>
<td align="right">124</td>
<td align="right">154</td>
</tr>
<tr class="even">
<td align="left">ENSG00000000938</td>
<td align="left">FGR</td>
<td align="left">ENSG00000000938</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000000971</td>
<td align="left">CFH</td>
<td align="left">ENSG00000000971</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">10</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">ENSG00000001036</td>
<td align="left">FUCA2</td>
<td align="left">ENSG00000001036</td>
<td align="right">2251</td>
<td align="right">860</td>
<td align="right">819</td>
<td align="right">732</td>
<td align="right">1071</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000001084</td>
<td align="left">GCLC</td>
<td align="left">ENSG00000001084</td>
<td align="right">980</td>
<td align="right">833</td>
<td align="right">694</td>
<td align="right">615</td>
<td align="right">959</td>
</tr>
<tr class="even">
<td align="left">ENSG00000001167</td>
<td align="left">NFYA</td>
<td align="left">ENSG00000001167</td>
<td align="right">886</td>
<td align="right">991</td>
<td align="right">889</td>
<td align="right">1164</td>
<td align="right">1000</td>
</tr>
<tr class="odd">
<td align="left">ENSG00000001460</td>
<td align="left">STPG1</td>
<td align="left">ENSG00000001460</td>
<td align="right">239</td>
<td align="right">215</td>
<td align="right">142</td>
<td align="right">171</td>
<td align="right">225</td>
</tr>
<tr class="even">
<td align="left">ENSG00000001461</td>
<td align="left">NIPAL3</td>
<td align="left">ENSG00000001461</td>
<td align="right">402</td>
<td align="right">798</td>
<td align="right">664</td>
<td align="right">777</td>
<td align="right">907</td>
</tr>
</tbody>
</table>
</div>
<div id="question-4-1" class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Question 4<a href="exercises.html#question-4-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>GSE122380 uses stable Ensembl IDs without version suffixes, whereas your
previous file used versioned IDs (e.g., .5) that required stripping,
which made is simpler to map to HGNC.</p>
</div>
</div>
<div id="exercise-3--" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Exercise 3 -<a href="exercises.html#exercise-3--" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Can you use the worked example to process the above two GEO records? How?</p>
<p>Yes — you can process both GEO records using the exact same workflow but with
minor change in variables and remove the stripping version number step if not
needed.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="worked-examples-with-beforeafter-tables.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["bcb420_identifier_mapping.pdf", "bcb420_identifier_mapping.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
